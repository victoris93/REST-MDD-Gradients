
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Results &#8212; Biomarkers of Major Depressive Disorder. An Analysis of Macro-Scale Cortical Gradients</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.5f77b4aec8189eecf79907ce328c390d.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Discussion" href="Discussion.html" />
    <link rel="prev" title="Methodology" href="Methodology.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      <h1 class="site-logo" id="site-title">Biomarkers of Major Depressive Disorder. An Analysis of Macro-Scale Cortical Gradients</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Abstract.html">
   Abstract
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Methodology.html">
   Methodology
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Results
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Discussion.html">
   Discussion
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Results.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/Results.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#altered-gradients-of-the-visual-and-default-mode-networks-in-drug-naive-patients">
   Altered Gradients of the Visual and Default Mode Networks in Drug-Naïve Patients
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#disruption-of-the-second-gradient-within-ventral-attention-network-in-patients-on-medication">
   Disruption of the second Gradient within Ventral Attention Network in Patients on Medication
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="results">
<h1>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h1>
<div class="cell tag_hide-output tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nibabel.testing</span> <span class="kn">import</span> <span class="n">data_path</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">plotting</span><span class="p">,</span> <span class="n">regions</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">nibabel</span> <span class="k">as</span> <span class="nn">nib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.io</span> <span class="k">as</span> <span class="nn">sio</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">index_img</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">ttest_ind</span>
<span class="kn">import</span> <span class="nn">mvlearn</span>
<span class="kn">from</span> <span class="nn">IPython.core.interactiveshell</span> <span class="kn">import</span> <span class="n">InteractiveShell</span>
<span class="n">InteractiveShell</span><span class="o">.</span><span class="n">ast_node_interactivity</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/VictoriaShevchenko/.local/lib/python3.8/site-packages/nilearn/datasets/__init__.py:87: FutureWarning: Fetchers from the nilearn.datasets module will be updated in version 0.9 to return python strings instead of bytes and Pandas dataframes instead of Numpy arrays.
  warn(&quot;Fetchers from the nilearn.datasets module will be &quot;
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">OSError</span><span class="g g-Whitespace">                                   </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">456</span><span class="n">f7b7159f9</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">index_img</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">ttest_ind</span>
<span class="ne">---&gt; </span><span class="mi">11</span> <span class="kn">import</span> <span class="nn">mvlearn</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="kn">from</span> <span class="nn">IPython.core.interactiveshell</span> <span class="kn">import</span> <span class="n">InteractiveShell</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="n">InteractiveShell</span><span class="o">.</span><span class="n">ast_node_interactivity</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>

<span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">mvlearn</span><span class="o">-</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">py3</span><span class="o">.</span><span class="mf">8.</span><span class="n">egg</span><span class="o">/</span><span class="n">mvlearn</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">mvlearn.embed</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">mvlearn.cluster</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">mvlearn.semi_supervised</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">mvlearn.datasets</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">import</span> <span class="nn">mvlearn.utils</span>

<span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">mvlearn</span><span class="o">-</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">py3</span><span class="o">.</span><span class="mf">8.</span><span class="n">egg</span><span class="o">/</span><span class="n">mvlearn</span><span class="o">/</span><span class="n">embed</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span> 
<span class="g g-Whitespace">     </span><span class="mi">18</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">19</span>     <span class="kn">from</span> <span class="nn">.omnibus</span> <span class="kn">import</span> <span class="n">Omnibus</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span> <span class="k">except</span> <span class="ne">ModuleNotFoundError</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span>     <span class="k">pass</span>

<span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">mvlearn</span><span class="o">-</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">py3</span><span class="o">.</span><span class="mf">8.</span><span class="n">egg</span><span class="o">/</span><span class="n">mvlearn</span><span class="o">/</span><span class="n">embed</span><span class="o">/</span><span class="n">omnibus</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span> 
<span class="g g-Whitespace">     </span><span class="mi">19</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">20</span>     <span class="kn">from</span> <span class="nn">graspy.embed</span> <span class="kn">import</span> <span class="n">OmnibusEmbed</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span> <span class="k">except</span> <span class="ne">ModuleNotFoundError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">22</span>     <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">. package graspy required for this function. &quot;</span> <span class="o">+</span>

<span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">graspy</span><span class="o">-</span><span class="mf">0.3</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">py3</span><span class="o">.</span><span class="mf">8.</span><span class="n">egg</span><span class="o">/</span><span class="n">graspy</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">graspy.datasets</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">import</span> <span class="nn">graspy.embed</span>
<span class="ne">----&gt; </span><span class="mi">6</span> <span class="kn">import</span> <span class="nn">graspy.inference</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="kn">import</span> <span class="nn">graspy.models</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="kn">import</span> <span class="nn">graspy.pipeline</span>

<span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">graspy</span><span class="o">-</span><span class="mf">0.3</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">py3</span><span class="o">.</span><span class="mf">8.</span><span class="n">egg</span><span class="o">/</span><span class="n">graspy</span><span class="o">/</span><span class="n">inference</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">.latent_position_test</span> <span class="kn">import</span> <span class="n">LatentPositionTest</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="kn">from</span> <span class="nn">.latent_distribution_test</span> <span class="kn">import</span> <span class="n">LatentDistributionTest</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> 
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;LatentPositionTest&quot;</span><span class="p">,</span> <span class="s2">&quot;LatentDistributionTest&quot;</span><span class="p">]</span>

<span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">graspy</span><span class="o">-</span><span class="mf">0.3</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">py3</span><span class="o">.</span><span class="mf">8.</span><span class="n">egg</span><span class="o">/</span><span class="n">graspy</span><span class="o">/</span><span class="n">inference</span><span class="o">/</span><span class="n">latent_distribution_test</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">25</span> <span class="kn">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="kn">import</span> <span class="n">PAIRED_DISTANCES</span>
<span class="g g-Whitespace">     </span><span class="mi">26</span> <span class="kn">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="kn">import</span> <span class="n">PAIRWISE_KERNEL_FUNCTIONS</span>
<span class="ne">---&gt; </span><span class="mi">27</span> <span class="kn">from</span> <span class="nn">hyppo.ksample</span> <span class="kn">import</span> <span class="n">KSample</span>
<span class="g g-Whitespace">     </span><span class="mi">28</span> <span class="kn">from</span> <span class="nn">hyppo._utils</span> <span class="kn">import</span> <span class="n">gaussian</span>
<span class="g g-Whitespace">     </span><span class="mi">29</span> 

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load</span><span class="nt">(name, import_)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load_unlocked</span><span class="nt">(name, import_)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_load_unlocked</span><span class="nt">(spec)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_load_backward_compatible</span><span class="nt">(spec)</span>

<span class="nn">&lt;frozen zipimport&gt;</span> in <span class="ni">load_module</span><span class="nt">(self, fullname)</span>

<span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">hyppo</span><span class="o">-</span><span class="mf">0.2</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">py3</span><span class="o">.</span><span class="mf">8.</span><span class="n">egg</span><span class="o">/</span><span class="n">hyppo</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">hyppo.discrim</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">hyppo.independence</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">hyppo.ksample</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">hyppo.time_series</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">import</span> <span class="nn">hyppo.tools</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load</span><span class="nt">(name, import_)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load_unlocked</span><span class="nt">(name, import_)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_load_unlocked</span><span class="nt">(spec)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_load_backward_compatible</span><span class="nt">(spec)</span>

<span class="nn">&lt;frozen zipimport&gt;</span> in <span class="ni">load_module</span><span class="nt">(self, fullname)</span>

<span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">hyppo</span><span class="o">-</span><span class="mf">0.2</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">py3</span><span class="o">.</span><span class="mf">8.</span><span class="n">egg</span><span class="o">/</span><span class="n">hyppo</span><span class="o">/</span><span class="n">discrim</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">.discrim_one_samp</span> <span class="kn">import</span> <span class="n">DiscrimOneSample</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">from</span> <span class="nn">.discrim_two_samp</span> <span class="kn">import</span> <span class="n">DiscrimTwoSample</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> 
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">()]</span>  <span class="c1"># add imported tests to __all__</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load</span><span class="nt">(name, import_)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load_unlocked</span><span class="nt">(name, import_)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_load_unlocked</span><span class="nt">(spec)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_load_backward_compatible</span><span class="nt">(spec)</span>

<span class="nn">&lt;frozen zipimport&gt;</span> in <span class="ni">load_module</span><span class="nt">(self, fullname)</span>

<span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">hyppo</span><span class="o">-</span><span class="mf">0.2</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">py3</span><span class="o">.</span><span class="mf">8.</span><span class="n">egg</span><span class="o">/</span><span class="n">hyppo</span><span class="o">/</span><span class="n">discrim</span><span class="o">/</span><span class="n">discrim_one_samp</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">from</span> <span class="nn">scipy._lib._util</span> <span class="kn">import</span> <span class="n">MapWrapper</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> 
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="kn">from</span> <span class="nn">._utils</span> <span class="kn">import</span> <span class="n">_CheckInputs</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">from</span> <span class="nn">.base</span> <span class="kn">import</span> <span class="n">DiscriminabilityTest</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> 

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load</span><span class="nt">(name, import_)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load_unlocked</span><span class="nt">(name, import_)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_load_unlocked</span><span class="nt">(spec)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_load_backward_compatible</span><span class="nt">(spec)</span>

<span class="nn">&lt;frozen zipimport&gt;</span> in <span class="ni">load_module</span><span class="nt">(self, fullname)</span>

<span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">hyppo</span><span class="o">-</span><span class="mf">0.2</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">py3</span><span class="o">.</span><span class="mf">8.</span><span class="n">egg</span><span class="o">/</span><span class="n">hyppo</span><span class="o">/</span><span class="n">discrim</span><span class="o">/</span><span class="n">_utils</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">pairwise_distances</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> 
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="kn">from</span> <span class="nn">..tools</span> <span class="kn">import</span> <span class="n">check_ndarray_xy</span><span class="p">,</span> <span class="n">check_reps</span><span class="p">,</span> <span class="n">contains_nan</span><span class="p">,</span> <span class="n">convert_xy_float64</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> 
<span class="g g-Whitespace">      </span><span class="mi">6</span> 

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load</span><span class="nt">(name, import_)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load_unlocked</span><span class="nt">(name, import_)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_load_unlocked</span><span class="nt">(spec)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_load_backward_compatible</span><span class="nt">(spec)</span>

<span class="nn">&lt;frozen zipimport&gt;</span> in <span class="ni">load_module</span><span class="nt">(self, fullname)</span>

<span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">hyppo</span><span class="o">-</span><span class="mf">0.2</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">py3</span><span class="o">.</span><span class="mf">8.</span><span class="n">egg</span><span class="o">/</span><span class="n">hyppo</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">from</span> <span class="nn">.indep_sim</span> <span class="kn">import</span> <span class="o">*</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">from</span> <span class="nn">.ksample_sim</span> <span class="kn">import</span> <span class="o">*</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="kn">from</span> <span class="nn">.power</span> <span class="kn">import</span> <span class="o">*</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">from</span> <span class="nn">.time_series_sim</span> <span class="kn">import</span> <span class="o">*</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> 

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load</span><span class="nt">(name, import_)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load_unlocked</span><span class="nt">(name, import_)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_load_unlocked</span><span class="nt">(spec)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_load_backward_compatible</span><span class="nt">(spec)</span>

<span class="nn">&lt;frozen zipimport&gt;</span> in <span class="ni">load_module</span><span class="nt">(self, fullname)</span>

<span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">hyppo</span><span class="o">-</span><span class="mf">0.2</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">py3</span><span class="o">.</span><span class="mf">8.</span><span class="n">egg</span><span class="o">/</span><span class="n">hyppo</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">power</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> 
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="kn">from</span> <span class="nn">..independence</span> <span class="kn">import</span> <span class="n">INDEP_TESTS</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">from</span> <span class="nn">..ksample</span> <span class="kn">import</span> <span class="n">KSAMP_TESTS</span><span class="p">,</span> <span class="n">KSample</span><span class="p">,</span> <span class="n">k_sample_transform</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="kn">from</span> <span class="nn">.indep_sim</span> <span class="kn">import</span> <span class="n">indep_sim</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load</span><span class="nt">(name, import_)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load_unlocked</span><span class="nt">(name, import_)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_load_unlocked</span><span class="nt">(spec)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_load_backward_compatible</span><span class="nt">(spec)</span>

<span class="nn">&lt;frozen zipimport&gt;</span> in <span class="ni">load_module</span><span class="nt">(self, fullname)</span>

<span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">hyppo</span><span class="o">-</span><span class="mf">0.2</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">py3</span><span class="o">.</span><span class="mf">8.</span><span class="n">egg</span><span class="o">/</span><span class="n">hyppo</span><span class="o">/</span><span class="n">independence</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">._utils</span> <span class="kn">import</span> <span class="n">sim_matrix</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">from</span> <span class="nn">.cca</span> <span class="kn">import</span> <span class="n">CCA</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="kn">from</span> <span class="nn">.dcorr</span> <span class="kn">import</span> <span class="n">Dcorr</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">from</span> <span class="nn">.hhg</span> <span class="kn">import</span> <span class="n">HHG</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">from</span> <span class="nn">.hsic</span> <span class="kn">import</span> <span class="n">Hsic</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load</span><span class="nt">(name, import_)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load_unlocked</span><span class="nt">(name, import_)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_load_unlocked</span><span class="nt">(spec)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/importlib/_bootstrap.py</span> in <span class="ni">_load_backward_compatible</span><span class="nt">(spec)</span>

<span class="nn">&lt;frozen zipimport&gt;</span> in <span class="ni">load_module</span><span class="nt">(self, fullname)</span>

<span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">hyppo</span><span class="o">-</span><span class="mf">0.2</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">py3</span><span class="o">.</span><span class="mf">8.</span><span class="n">egg</span><span class="o">/</span><span class="n">hyppo</span><span class="o">/</span><span class="n">independence</span><span class="o">/</span><span class="n">dcorr</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> 
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">from</span> <span class="nn">..tools</span> <span class="kn">import</span> <span class="n">check_perm_blocks_dim</span><span class="p">,</span> <span class="n">chi2_approx</span><span class="p">,</span> <span class="n">compute_dist</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">from</span> <span class="nn">._utils</span> <span class="kn">import</span> <span class="n">_CheckInputs</span>

<span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">numba</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="k">del</span> <span class="n">get_versions</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> 
<span class="ne">---&gt; </span><span class="mi">14</span> <span class="kn">from</span> <span class="nn">numba.core</span> <span class="kn">import</span> <span class="n">config</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> <span class="kn">from</span> <span class="nn">numba.testing</span> <span class="kn">import</span> <span class="n">_runtests</span> <span class="k">as</span> <span class="n">runtests</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span> <span class="kn">from</span> <span class="nn">numba.core</span> <span class="kn">import</span> <span class="n">types</span><span class="p">,</span> <span class="n">errors</span>

<span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">numba</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">config</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> 
<span class="g g-Whitespace">     </span><span class="mi">15</span> 
<span class="ne">---&gt; </span><span class="mi">16</span> <span class="kn">import</span> <span class="nn">llvmlite.binding</span> <span class="k">as</span> <span class="nn">ll</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span> 
<span class="g g-Whitespace">     </span><span class="mi">18</span> <span class="n">IS_WIN32</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;win32&#39;</span><span class="p">)</span>

<span class="o">~/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">llvmlite</span><span class="o">/</span><span class="n">binding</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">Things</span> <span class="n">that</span> <span class="n">rely</span> <span class="n">on</span> <span class="n">the</span> <span class="n">LLVM</span> <span class="n">library</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="ne">----&gt; </span><span class="mi">4</span><span class="s2"> from .dylib import *</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span><span class="s2"> from .executionengine import *</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span><span class="s2"> from .initfini import *</span>

<span class="s2">~/opt/anaconda3/lib/python3.8/site-packages/llvmlite/binding/dylib.py in &lt;module&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span><span class="s2"> from ctypes import c_void_p, c_char_p, c_bool, POINTER</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span><span class="s2"> </span>
<span class="ne">----&gt; </span><span class="mi">3</span><span class="s2"> from llvmlite.binding import ffi</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span><span class="s2"> from llvmlite.binding.common import _encode_string</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span><span class="s2"> </span>

<span class="s2">~/opt/anaconda3/lib/python3.8/site-packages/llvmlite/binding/ffi.py in &lt;module&gt;</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span><span class="s2">         break</span>
<span class="g g-Whitespace">    </span><span class="mi">152</span><span class="s2"> else:</span>
<span class="ne">--&gt; </span><span class="mi">153</span><span class="s2">     raise OSError(&quot;Could not load shared object file: </span><span class="si">{}</span><span class="s2">&quot;.format(_lib_name))</span>
<span class="g g-Whitespace">    </span><span class="mi">154</span><span class="s2"> </span>
<span class="g g-Whitespace">    </span><span class="mi">155</span><span class="s2"> </span>

<span class="ne">OSError</span>: Could not load shared object file: libllvmlite.dylib
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">current_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nilearn_HO_atlas</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_atlas_harvard_oxford</span><span class="p">(</span><span class="n">atlas_name</span> <span class="o">=</span> <span class="s2">&quot;cort-maxprob-thr25-2mm&quot;</span><span class="p">,</span> <span class="n">symmetric_split</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">atlas_ind_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_dir</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s1">&#39;HarvardOxford_Atlas_NewIndex_YCG.xlsx&#39;</span><span class="p">)</span>
<span class="n">HO_excel</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">atlas_ind_path</span><span class="p">)</span>
<span class="n">HO_indices_pd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">HO_excel</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;New Index&#39;</span><span class="p">])</span>
<span class="n">HO_indices_np</span> <span class="o">=</span> <span class="n">HO_indices_pd</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">nilearn_HO_atlas_L</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_atlas_harvard_oxford</span><span class="p">(</span><span class="n">atlas_name</span> <span class="o">=</span> <span class="s2">&quot;cort-maxprob-thr25-2mm&quot;</span><span class="p">,</span> <span class="n">symmetric_split</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">HO_cortical_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">HO_indices_np</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">HO_cortical_indices</span> <span class="o">=</span> <span class="n">HO_cortical_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">96</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">nilearn_HO_atlas</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">97</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">index_img</span>
<span class="kn">from</span> <span class="nn">nilearn.surface</span> <span class="kn">import</span> <span class="n">vol_to_surf</span>
<span class="kn">from</span> <span class="nn">nilearn.plotting.cm</span> <span class="kn">import</span> <span class="n">_cmap_d</span> <span class="k">as</span> <span class="n">nilearn_cmaps</span>
<span class="n">fsaverage</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_surf_fsaverage</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">get_surf_texture</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">atlas</span><span class="p">):</span>
    <span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">region_labels</span> <span class="o">=</span> <span class="n">regions</span><span class="o">.</span><span class="n">signals_to_img_labels</span><span class="p">(</span><span class="n">signals</span> <span class="o">=</span> <span class="n">signal</span><span class="p">,</span>
                                                <span class="n">labels_img</span> <span class="o">=</span> <span class="n">atlas</span><span class="p">)</span>
    <span class="n">vis</span> <span class="o">=</span> <span class="n">index_img</span><span class="p">(</span><span class="n">region_labels</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">texture_l</span> <span class="o">=</span> <span class="n">vol_to_surf</span><span class="p">(</span><span class="n">vis</span><span class="p">,</span> <span class="n">fsaverage</span><span class="p">[</span><span class="s1">&#39;pial_left&#39;</span><span class="p">])</span>
    <span class="n">texture_r</span> <span class="o">=</span> <span class="n">vol_to_surf</span><span class="p">(</span><span class="n">vis</span><span class="p">,</span> <span class="n">fsaverage</span><span class="p">[</span><span class="s1">&#39;pial_right&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">texture_l</span><span class="p">,</span> <span class="n">texture_r</span>

<span class="k">def</span> <span class="nf">plot_stat_surf</span><span class="p">(</span><span class="n">statistic</span><span class="p">,</span> <span class="n">surf_type</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">colorbar_1</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">colorbar_2</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">colorbar_3</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">colorbar_4</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">darkness</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">):</span>
    <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">),</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span> 
    <span class="n">texture_l</span><span class="p">,</span> <span class="n">texture_r</span> <span class="o">=</span> <span class="n">get_surf_texture</span><span class="p">(</span><span class="n">statistic</span><span class="p">,</span> <span class="n">nilearn_HO_atlas</span><span class="p">[</span><span class="s1">&#39;maps&#39;</span><span class="p">])</span>
    <span class="n">plotting</span><span class="o">.</span><span class="n">plot_surf_stat_map</span><span class="p">(</span><span class="n">fsaverage</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_left&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">surf_type</span><span class="p">)],</span> <span class="n">texture_l</span><span class="p">,</span> <span class="n">hemi</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">view</span> <span class="o">=</span> <span class="s1">&#39;lateral&#39;</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.00000001</span><span class="p">,</span>
                            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;LH, Lateral&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="n">colorbar_1</span><span class="p">,</span> <span class="n">darkness</span> <span class="o">=</span> <span class="n">darkness</span><span class="p">,</span> <span class="n">bg_on_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figure</span> <span class="o">=</span> <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                            <span class="n">bg_map</span><span class="o">=</span><span class="n">fsaverage</span><span class="o">.</span><span class="n">sulc_left</span><span class="p">)</span>
    <span class="n">plotting</span><span class="o">.</span><span class="n">plot_surf_stat_map</span><span class="p">(</span><span class="n">fsaverage</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_left&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">surf_type</span><span class="p">)],</span> <span class="n">texture_l</span><span class="p">,</span> <span class="n">hemi</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">view</span> <span class="o">=</span> <span class="s1">&#39;medial&#39;</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.00000001</span><span class="p">,</span>
                            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;LH, Medial&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="n">colorbar_2</span><span class="p">,</span> <span class="n">darkness</span> <span class="o">=</span> <span class="n">darkness</span><span class="p">,</span> <span class="n">bg_on_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figure</span> <span class="o">=</span> <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                            <span class="n">bg_map</span><span class="o">=</span><span class="n">fsaverage</span><span class="o">.</span><span class="n">sulc_left</span><span class="p">)</span>
    <span class="n">plotting</span><span class="o">.</span><span class="n">plot_surf_stat_map</span><span class="p">(</span><span class="n">fsaverage</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_right&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">surf_type</span><span class="p">)],</span> <span class="n">texture_r</span><span class="p">,</span> <span class="n">hemi</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">view</span> <span class="o">=</span> <span class="s1">&#39;medial&#39;</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.00000001</span><span class="p">,</span>
                            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;RH, Medial&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">,</span>  <span class="n">colorbar</span><span class="o">=</span><span class="n">colorbar_3</span><span class="p">,</span> <span class="n">darkness</span> <span class="o">=</span> <span class="n">darkness</span><span class="p">,</span> <span class="n">bg_on_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figure</span> <span class="o">=</span> <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                            <span class="n">bg_map</span><span class="o">=</span><span class="n">fsaverage</span><span class="o">.</span><span class="n">sulc_right</span><span class="p">)</span>
    <span class="n">plotting</span><span class="o">.</span><span class="n">plot_surf_stat_map</span><span class="p">(</span><span class="n">fsaverage</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_right&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">surf_type</span><span class="p">)],</span> <span class="n">texture_r</span><span class="p">,</span> <span class="n">hemi</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">view</span> <span class="o">=</span> <span class="s1">&#39;lateral&#39;</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.00000001</span><span class="p">,</span>
                            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;RH, Lateral&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="n">colorbar_4</span><span class="p">,</span> <span class="n">darkness</span> <span class="o">=</span> <span class="n">darkness</span><span class="p">,</span> <span class="n">bg_on_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figure</span> <span class="o">=</span> <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                            <span class="n">bg_map</span><span class="o">=</span><span class="n">fsaverage</span><span class="o">.</span><span class="n">sulc_right</span><span class="p">)</span>

    
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fmri_ind_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_dir</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;ROISignals_FunImgARCWF&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;ROISignals_</span><span class="si">%s</span><span class="s2">.mat&quot;</span><span class="p">)</span>
<span class="n">phenotype_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_dir</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;REST-meta-MDD-PhenotypicData_WithHAMDSubItem_V4.xlsx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Importing drug naïve subjects with MDD</span>
<span class="n">data_DN_MDD</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># N = 446 </span>

<span class="n">subj_excel_DN_MDD</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">phenotype_path</span><span class="p">,</span> <span class="n">sheet_name</span> <span class="o">=</span> <span class="s1">&#39;Drug Naïve MDD&#39;</span><span class="p">,</span> <span class="n">converters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span><span class="nb">str</span><span class="p">})</span>
<span class="n">subj_excel_DN_MDD</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Drug-Naïve MDDs&#39;</span>
<span class="n">df_subj_DN_MDD</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">subj_excel_DN_MDD</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Education (years)&#39;</span><span class="p">,</span> <span class="s1">&#39;Group&#39;</span><span class="p">])</span>
<span class="n">df_subj_DN_MDD</span> <span class="o">=</span> <span class="n">df_subj_DN_MDD</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">45</span><span class="p">])</span>

<span class="n">subj_ID_DN_MDD</span> <span class="o">=</span> <span class="n">df_subj_DN_MDD</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">subj_ID_DN_MDD_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">subj_ID_DN_MDD</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>

<span class="k">for</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">subj_ID_DN_MDD_array</span><span class="p">:</span>
    <span class="n">DN_MDD_matlab_file</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">fmri_ind_path</span> <span class="o">%</span> <span class="n">subject</span><span class="p">)</span>
    <span class="n">DN_MDD_timeseries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">DN_MDD_matlab_file</span><span class="p">[</span><span class="s2">&quot;ROISignals&quot;</span><span class="p">][:,</span> <span class="mi">116</span><span class="p">:</span><span class="mi">212</span><span class="p">])</span>
    <span class="n">data_DN_MDD</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DN_MDD_timeseries</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Importing subjects on medication</span>
<span class="n">data_MED_MDD</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># N = 382</span>

<span class="n">subj_excel_MED_MDD</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">phenotype_path</span><span class="p">,</span> <span class="n">sheet_name</span> <span class="o">=</span> <span class="s1">&#39;On Medication&#39;</span><span class="p">,</span> <span class="n">converters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span><span class="nb">str</span><span class="p">})</span>
<span class="n">subj_excel_MED_MDD</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;MDDs on Medication&#39;</span>
<span class="n">df_subj_MED_MDD</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">subj_excel_MED_MDD</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Education (years)&#39;</span><span class="p">,</span> <span class="s1">&#39;Group&#39;</span><span class="p">])</span>
<span class="n">df_subj_MED_MDD</span> <span class="o">=</span> <span class="n">df_subj_MED_MDD</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">117</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">124</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span> <span class="mi">133</span><span class="p">,</span> <span class="mi">134</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">136</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">138</span><span class="p">,</span> <span class="mi">139</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">143</span><span class="p">])</span>

<span class="n">subj_ID_MED_MDD</span> <span class="o">=</span> <span class="n">df_subj_MED_MDD</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">subj_ID_MED_MDD_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">subj_ID_MED_MDD</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>

<span class="k">for</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">subj_ID_MED_MDD_array</span><span class="p">:</span>
    <span class="n">MED_MDD_matlab_file</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">fmri_ind_path</span> <span class="o">%</span> <span class="n">subject</span><span class="p">)</span>
    <span class="n">MED_MDD_timeseries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">MED_MDD_matlab_file</span><span class="p">[</span><span class="s2">&quot;ROISignals&quot;</span><span class="p">][:,</span> <span class="mi">116</span><span class="p">:</span><span class="mi">212</span><span class="p">])</span>
    <span class="n">data_MED_MDD</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MED_MDD_timeseries</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Importing controls</span>
<span class="n">data_NC</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># N = 446 </span>

<span class="n">subj_excel_NC</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">phenotype_path</span><span class="p">,</span> <span class="n">sheet_name</span> <span class="o">=</span> <span class="s1">&#39;Controls&#39;</span><span class="p">,</span> <span class="n">converters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span><span class="nb">str</span><span class="p">})</span>
<span class="n">subj_excel_NC</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Controls&#39;</span>
<span class="n">df_subj_NC</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">subj_excel_NC</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Education (years)&#39;</span><span class="p">,</span> <span class="s1">&#39;Group&#39;</span><span class="p">])</span>
<span class="n">df_subj_NC</span> <span class="o">=</span> <span class="n">df_subj_NC</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">91</span><span class="p">,</span><span class="mi">92</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">221</span><span class="p">,</span> <span class="mi">222</span><span class="p">,</span> <span class="mi">223</span><span class="p">,</span> <span class="mi">270</span><span class="p">,</span> <span class="mi">271</span><span class="p">,</span> <span class="mi">272</span><span class="p">,</span> <span class="mi">273</span><span class="p">,</span> <span class="mi">274</span><span class="p">,</span> <span class="mi">275</span><span class="p">,</span> <span class="mi">276</span><span class="p">])</span>
<span class="n">df_subj_NC</span> <span class="o">=</span> <span class="n">df_subj_NC</span><span class="p">[</span><span class="n">df_subj_NC</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span> <span class="c1"># removing subjects with age == 0</span>

<span class="n">subj_ID_NC</span> <span class="o">=</span> <span class="n">df_subj_NC</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">subj_ID_NC_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">subj_ID_NC</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>

<span class="k">for</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">subj_ID_NC_array</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">446</span><span class="p">]:</span>
    <span class="n">NC_matlab_file</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">fmri_ind_path</span> <span class="o">%</span> <span class="n">subject</span><span class="p">)</span>
    <span class="n">NC_timeseries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">NC_matlab_file</span><span class="p">[</span><span class="s2">&quot;ROISignals&quot;</span><span class="p">][:,</span> <span class="mi">116</span><span class="p">:</span><span class="mi">212</span><span class="p">])</span>
    <span class="n">data_NC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NC_timeseries</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> 
 
<span class="n">data_NC_small</span> <span class="o">=</span> <span class="n">data_NC</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">382</span><span class="p">]</span> <span class="c1"># N = 382 for the comparison with the subjects on meds</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_desc_stat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_subj_DN_MDD</span><span class="p">,</span> <span class="n">df_subj_MED_MDD</span><span class="p">,</span> <span class="n">df_subj_NC</span><span class="p">[:</span><span class="mi">446</span><span class="p">]],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Regular expressions to extract site</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="n">site</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?&lt;=S)[0-9]+&#39;</span><span class="p">)</span>
<span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Site&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
<span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Site&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Site&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
<span class="n">site_order</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Site&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">(),</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Site&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Site&#39;</span><span class="p">],</span> <span class="n">site_order</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#All data</span>
<span class="n">ALL_DATA</span> <span class="o">=</span> <span class="n">data_DN_MDD</span> <span class="o">+</span> <span class="n">data_MED_MDD</span> <span class="o">+</span> <span class="n">data_NC</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Fitting on the data of all subjects</span>

<span class="kn">from</span> <span class="nn">mvlearn.embed</span> <span class="kn">import</span> <span class="n">GCCA</span>

<span class="n">gcca</span> <span class="o">=</span> <span class="n">GCCA</span><span class="p">(</span><span class="n">n_components</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># or specify another thresholding eg, n_components=5 or fraction_var=0.8</span>

<span class="n">gcca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ALL_DATA</span><span class="p">)</span>

<span class="n">projs</span> <span class="o">=</span> <span class="n">gcca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">ALL_DATA</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GCCA(n_components=2)
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dividing GCCA-transformed data into groups</span>
<span class="n">projs_DN_MDD</span> <span class="o">=</span> <span class="n">projs</span><span class="p">[:</span><span class="mi">446</span><span class="p">]</span>
<span class="n">projs_MED_MDD</span> <span class="o">=</span> <span class="n">projs</span><span class="p">[</span><span class="mi">446</span><span class="p">:</span><span class="mi">828</span><span class="p">]</span>
<span class="n">projs_NC</span> <span class="o">=</span> <span class="n">projs</span><span class="p">[</span><span class="mi">828</span><span class="p">:]</span>
<span class="n">projs_NC_small</span> <span class="o">=</span> <span class="n">projs</span><span class="p">[</span><span class="mi">828</span><span class="p">:</span><span class="mi">1210</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Numpy arrays containing dependent variables (Gradient Scores)</span>
<span class="n">projs_DN_NC_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">projs_DN_MDD</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">projs_NC</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]))</span>
<span class="n">projs_DN_NC_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">projs_DN_MDD</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">projs_NC</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]))</span>

<span class="n">projs_MED_NC_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">projs_MED_MDD</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">projs_NC</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]))</span>
<span class="n">projs_MED_NC_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">projs_MED_MDD</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">projs_NC</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Numpy arrays containing explanatory variables (Group)</span>
<span class="n">group_DN_NC</span> <span class="o">=</span> <span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">][(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Drug-Naïve MDDs&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Controls&#39;</span><span class="p">)]</span>
<span class="n">group_DN_NC</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">group_DN_NC</span> <span class="o">==</span> <span class="s1">&#39;Drug-Naïve MDDs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">group_DN_NC</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">group_DN_NC</span> <span class="o">==</span> <span class="s1">&#39;Controls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">group_DN_NC</span> <span class="o">=</span> <span class="n">group_DN_NC</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="n">group_MED_NC</span> <span class="o">=</span> <span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">][(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MDDs on Medication&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Controls&#39;</span><span class="p">)]</span>
<span class="n">group_MED_NC</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">group_MED_NC</span> <span class="o">==</span> <span class="s1">&#39;MDDs on Medication&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">group_MED_NC</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">group_MED_NC</span> <span class="o">==</span> <span class="s1">&#39;Controls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">group_MED_NC</span> <span class="o">=</span> <span class="n">group_MED_NC</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dummy variables for sex: 0 = male, 1 = female</span>
<span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Numpy arrays containing confounding (nuisance) variables (Sex, Age, Education &amp; Site)</span>
<span class="n">sex_DN_NC</span> <span class="o">=</span> <span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">][(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Drug-Naïve MDDs&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Controls&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">age_DN_NC</span> <span class="o">=</span> <span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">][(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Drug-Naïve MDDs&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Controls&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">education_DN_NC</span> <span class="o">=</span> <span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Education (years)&#39;</span><span class="p">][(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Drug-Naïve MDDs&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Controls&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">site_DN_NC</span> <span class="o">=</span> <span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Site&#39;</span><span class="p">][(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Drug-Naïve MDDs&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Controls&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="n">sex_MED_NC</span> <span class="o">=</span> <span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">][(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MDDs on Medication&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Controls&#39;</span><span class="p">)][:</span><span class="mi">382</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">age_MED_NC</span> <span class="o">=</span> <span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">][(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MDDs on Medication&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Controls&#39;</span><span class="p">)][:</span><span class="mi">382</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">education_MED_NC</span> <span class="o">=</span> <span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Education (years)&#39;</span><span class="p">][(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MDDs on Medication&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Controls&#39;</span><span class="p">)][:</span><span class="mi">382</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">site_MED_NC</span> <span class="o">=</span> <span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Site&#39;</span><span class="p">][(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MDDs on Medication&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df_desc_stat</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Controls&#39;</span><span class="p">)][:</span><span class="mi">382</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="n">group_DN_NC</span> <span class="o">=</span> <span class="n">group_DN_NC</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
<span class="n">site_DN_NC</span> <span class="o">=</span> <span class="n">site_DN_NC</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="n">group_MED_NC</span> <span class="o">=</span> <span class="n">group_MED_NC</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
<span class="n">site_MED_NC</span> <span class="o">=</span> <span class="n">site_MED_NC</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 3-D array containing confounding vars</span>
<span class="n">conf_vars_DN_NC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sex_DN_NC</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">892</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
                                  <span class="n">age_DN_NC</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">892</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
                                  <span class="n">education_DN_NC</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">892</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                                  <span class="n">site_DN_NC</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">892</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> 
                                   <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conf_vars_MED_NC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sex_MED_NC</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">382</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
                                   <span class="n">age_MED_NC</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">382</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
                                   <span class="n">education_MED_NC</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">382</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                                   <span class="n">site_MED_NC</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">382</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> 
                                   <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.mass_univariate</span> <span class="kn">import</span> <span class="n">permuted_ols</span>

<span class="n">permuted_DN_NC_1</span> <span class="o">=</span> <span class="n">permuted_ols</span><span class="p">(</span><span class="n">group_DN_NC</span><span class="p">,</span>
                                <span class="n">projs_DN_NC_1</span><span class="p">,</span>
                                <span class="n">conf_vars_DN_NC</span><span class="p">,</span>
                                <span class="n">model_intercept</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">permuted_DN_NC_2</span> <span class="o">=</span> <span class="n">permuted_ols</span><span class="p">(</span><span class="n">group_DN_NC</span><span class="p">,</span>
                                <span class="n">projs_DN_NC_2</span><span class="p">,</span>
                                <span class="n">conf_vars_DN_NC</span><span class="p">,</span>
                                <span class="n">model_intercept</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">permuted_MED_NC_1</span> <span class="o">=</span> <span class="n">permuted_ols</span><span class="p">(</span><span class="n">group_MED_NC</span><span class="p">[:</span><span class="mi">382</span><span class="o">*</span><span class="mi">2</span><span class="p">],</span>
                                <span class="n">projs_MED_NC_1</span><span class="p">[:</span><span class="mi">382</span><span class="o">*</span><span class="mi">2</span><span class="p">],</span>
                                <span class="n">conf_vars_MED_NC</span><span class="p">,</span>
                                <span class="n">model_intercept</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">permuted_MED_NC_2</span> <span class="o">=</span> <span class="n">permuted_ols</span><span class="p">(</span><span class="n">group_MED_NC</span><span class="p">[:</span><span class="mi">382</span><span class="o">*</span><span class="mi">2</span><span class="p">],</span>
                                <span class="n">projs_MED_NC_2</span><span class="p">[:</span><span class="mi">382</span><span class="o">*</span><span class="mi">2</span><span class="p">],</span>
                                <span class="n">conf_vars_MED_NC</span><span class="p">,</span>
                                <span class="n">model_intercept</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># permuted_ols returns -log10 p-values. Undoing the -log10 transform</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">96</span><span class="p">):</span>
    <span class="n">permuted_DN_NC_1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">permuted_DN_NC_1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">96</span><span class="p">):</span>
    <span class="n">permuted_DN_NC_2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">permuted_DN_NC_2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">96</span><span class="p">):</span>
    <span class="n">permuted_MED_NC_1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">permuted_MED_NC_1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">96</span><span class="p">):</span>
    <span class="n">permuted_MED_NC_2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">permuted_MED_NC_2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Function: t-statistic to Cohen&#39;s d</span>
<span class="k">def</span> <span class="nf">t_to_cohens_d</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>
    <span class="k">if</span> <span class="n">n1</span> <span class="o">==</span> <span class="n">n2</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">t</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">n1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">n2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">d</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ols_perm_d_DN_NC_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">96</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">96</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">permuted_DN_NC_1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="n">ols_perm_d_DN_NC_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_to_cohens_d</span><span class="p">(</span><span class="n">permuted_DN_NC_1</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="mi">446</span><span class="p">,</span> <span class="mi">446</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">permuted_DN_NC_1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="n">ols_perm_d_DN_NC_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ols_perm_d_DN_NC_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">96</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">96</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">permuted_DN_NC_2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="n">ols_perm_d_DN_NC_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_to_cohens_d</span><span class="p">(</span><span class="n">permuted_DN_NC_2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="mi">446</span><span class="p">,</span> <span class="mi">446</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">permuted_DN_NC_2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="n">ols_perm_d_DN_NC_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ols_perm_d_MED_NC_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">96</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">96</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">permuted_MED_NC_1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="n">ols_perm_d_MED_NC_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_to_cohens_d</span><span class="p">(</span><span class="n">permuted_MED_NC_1</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="mi">446</span><span class="p">,</span> <span class="mi">446</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">permuted_MED_NC_1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="n">ols_perm_d_MED_NC_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ols_perm_d_MED_NC_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">96</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">96</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">permuted_MED_NC_2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="n">ols_perm_d_MED_NC_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_to_cohens_d</span><span class="p">(</span><span class="n">permuted_MED_NC_2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="mi">446</span><span class="p">,</span> <span class="mi">446</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">permuted_MED_NC_2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="n">ols_perm_d_MED_NC_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Check all Cohen&#39;s d values and HO labels</span>
<span class="k">def</span> <span class="nf">print_cohen_d</span><span class="p">(</span><span class="n">cohen_d_array</span><span class="p">):</span>
    <span class="n">len_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">cohen_d_array</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">len_array</span><span class="p">)):</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">cohen_d_array</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">cohen_d</span> <span class="o">=</span> <span class="n">cohen_d_array</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">cohen_d_array</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="s2">&quot;, Cohen&#39;s d = &quot;</span><span class="p">,</span> <span class="n">cohen_d</span><span class="p">)</span>
        
</pre></div>
</div>
</div>
</div>
<div class="section" id="altered-gradients-of-the-visual-and-default-mode-networks-in-drug-naive-patients">
<h2>Altered Gradients of the Visual and Default Mode Networks in Drug-Naïve Patients<a class="headerlink" href="#altered-gradients-of-the-visual-and-default-mode-networks-in-drug-naive-patients" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Function generating a dataframe for the pointplot</span>
<span class="k">def</span> <span class="nf">pointplot_df</span><span class="p">(</span><span class="n">sig_d_array</span><span class="p">,</span> <span class="n">gradient_MDD</span><span class="p">,</span> <span class="n">gradient_NC</span><span class="p">,</span> <span class="n">gradient_ind</span><span class="p">,</span> <span class="n">ROI_labels</span><span class="p">,</span> <span class="n">group_names</span><span class="p">):</span>
    <span class="n">ind_sig</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sig_d_array</span> <span class="o">&lt;=</span> <span class="o">.</span><span class="mi">05</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ind_sig</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">gradient_MDD</span><span class="p">[:,</span> <span class="n">ind_sig</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">gradient_ind</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">gradient_NC</span><span class="p">[:,</span> <span class="n">ind_sig</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">gradient_ind</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind_sig</span><span class="p">)):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">gradient_MDD</span><span class="p">[:,</span> <span class="n">ind_sig</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">gradient_ind</span><span class="p">]))</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y</span><span class="p">,</span> <span class="n">gradient_NC</span><span class="p">[:,</span> <span class="n">ind_sig</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">gradient_ind</span><span class="p">]))</span>
        <span class="n">np_grads</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">np_grads</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">df</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np_grads</span>
        <span class="n">df_grads</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Gradient Score&quot;</span><span class="p">,</span> <span class="s2">&quot;ROI&quot;</span><span class="p">,</span> <span class="s2">&quot;Group&quot;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind_sig</span><span class="p">)):</span>
            <span class="n">df_grads</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">df_grads</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">ind_sig</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">:(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_grads</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">ind_sig</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;ROI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ROI_labels</span><span class="p">[</span><span class="n">ind_sig</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind_sig</span><span class="p">)):</span>
            <span class="n">df_grads</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">df_grads</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_grads</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">ind_sig</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">df_grads</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_grads</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">ind_sig</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ROI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ROI_labels</span><span class="p">[</span><span class="n">ind_sig</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">df_grads</span><span class="o">.</span><span class="n">loc</span><span class="p">[:(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_grads</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">df_grads</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">df_grads</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">:,</span> <span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_names</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">df_grads</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No significant difference between groups.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1st Gradient, Drug-Naïve MDDs vs. Controls:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">print_cohen_d</span><span class="p">(</span><span class="n">ols_perm_d_DN_NC_1</span><span class="p">)</span>
<span class="n">plot_stat_surf</span><span class="p">(</span><span class="n">ols_perm_d_DN_NC_1</span><span class="p">,</span> <span class="s1">&#39;pial&#39;</span><span class="p">,</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">colorbar_4</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">darkness</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">)</span>

<span class="n">data_sig_regions_DN_NC_1</span> <span class="o">=</span> <span class="n">pointplot_df</span><span class="p">(</span><span class="n">permuted_DN_NC_1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">projs_DN_MDD</span><span class="p">,</span> <span class="n">projs_NC</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Drug-Naïve MDDs&#39;</span><span class="p">,</span>
                                                                                                   <span class="s1">&#39;Controls&#39;</span><span class="p">])</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>

<span class="c1"># Initialize the figure</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="c1"># Show the conditional means</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Gradient Score&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;ROI&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Group&quot;</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">],</span>
              <span class="n">data</span><span class="o">=</span><span class="n">data_sig_regions_DN_NC_1</span><span class="p">[</span><span class="n">data_sig_regions_DN_NC_1</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Drug-Naïve MDDs&#39;</span><span class="p">],</span> <span class="n">dodge</span><span class="o">=.</span><span class="mi">532</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([],[],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Gradient Score&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;ROI&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Group&quot;</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">],</span>
              <span class="n">data</span><span class="o">=</span><span class="n">data_sig_regions_DN_NC_1</span><span class="p">[</span><span class="n">data_sig_regions_DN_NC_1</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Controls&#39;</span><span class="p">],</span> <span class="n">dodge</span><span class="o">=.</span><span class="mi">532</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([],[],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>

<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Gradient Score&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ROI&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>

<span class="c1"># Improve the legend</span>
<span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;tab:orange&quot;</span><span class="p">,</span> <span class="s2">&quot;tab:blue&quot;</span><span class="p">]</span>
<span class="n">handles</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">:</span>
    <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
    
<span class="n">handles</span> <span class="o">=</span> <span class="p">[(</span><span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">]</span>
<span class="n">new_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Controls, N = 446&#39;</span> <span class="p">,</span> <span class="s1">&#39;Drug-Naïve MDDs, N = 446&#39;</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;#00d648&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;#fe5400&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;#f700a5&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;#2a7f00&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;#2a7f00&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">new_labels</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;large&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">4.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1st Gradient, Drug-Naïve MDDs vs. Controls:

Left Intracalcarine Cortex , Cohen&#39;s d =  -0.25002809782558977
Left Cuneal Cortex , Cohen&#39;s d =  -0.24450691322255638
Left Lingual Gyrus , Cohen&#39;s d =  -0.24427351245544524
Left Supracalcarine Cortex , Cohen&#39;s d =  -0.2717323976643778
Right Supracalcarine Cortex , Cohen&#39;s d =  -0.2330562935835035
</pre></div>
</div>
<img alt="_images/Results_37_1.png" src="_images/Results_37_1.png" />
<img alt="_images/Results_37_2.png" src="_images/Results_37_2.png" />
</div>
</div>
<p>The analyses revealed a significant group difference between mean scores of the first, uni-to-transmodal gradient in the regions overlapping with the visual network (see above: the colors of the region labels on the y-axis correspond to the regions delineated in the Harvard-Oxford atlas). A closer comparison of the mean scores of the left intracalcarine cortex, left cuneal cortex, left lingual gyrus and right supracalcarine cortex revealed that while the values were in both groups distributed around zero, in the drug-naïve group, being on the negative side of the spectrum, they were closer to transmodal regions. The same is true for the left supracalcarine cortex with a score farther from zero in the transmodal direction than that of its equivalent in controls. These findings are in line with the results reported in <span id="id1">Yan <em>et al.</em> [<a class="reference internal" href="Discussion.html#id8">2019</a>]</span> , namely lower functional connectivity within the visual network in first-episode drug-naïve patients compared to controls.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">2nd Gradient, Drug-Naïve MDDs vs. Controls:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">print_cohen_d</span><span class="p">(</span><span class="n">ols_perm_d_DN_NC_2</span><span class="p">)</span>

<span class="n">plot_stat_surf</span><span class="p">(</span><span class="n">ols_perm_d_DN_NC_2</span><span class="p">,</span> <span class="s1">&#39;pial&#39;</span><span class="p">,</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">colorbar_2</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">darkness</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">)</span>

<span class="n">data_sig_regions_DN_NC_2</span> <span class="o">=</span> <span class="n">pointplot_df</span><span class="p">(</span><span class="n">permuted_DN_NC_2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">projs_DN_MDD</span><span class="p">,</span> <span class="n">projs_NC</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Drug-Naïve MDDs&#39;</span><span class="p">,</span>
                                                                                                   <span class="s1">&#39;Controls&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>

<span class="c1"># Initialize the figure</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Show the conditional means</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Gradient Score&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;ROI&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Group&quot;</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">],</span>
              <span class="n">data</span><span class="o">=</span><span class="n">data_sig_regions_DN_NC_2</span><span class="p">[</span><span class="n">data_sig_regions_DN_NC_2</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Drug-Naïve MDDs&#39;</span><span class="p">],</span> <span class="n">dodge</span><span class="o">=.</span><span class="mi">532</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">,</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([],[],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Gradient Score&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;ROI&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Group&quot;</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">],</span>
              <span class="n">data</span><span class="o">=</span><span class="n">data_sig_regions_DN_NC_2</span><span class="p">[</span><span class="n">data_sig_regions_DN_NC_2</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Controls&#39;</span><span class="p">],</span> <span class="n">dodge</span><span class="o">=.</span><span class="mi">532</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">,</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([],[],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span> <span class="mi">14</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span> <span class="mi">14</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Gradient Score&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ROI&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>

<span class="c1"># Improve the legend</span>
<span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;tab:orange&quot;</span><span class="p">,</span> <span class="s2">&quot;tab:blue&quot;</span><span class="p">]</span>
<span class="n">handles</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">:</span>
    <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
    
<span class="n">handles</span> <span class="o">=</span> <span class="p">[(</span><span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">]</span>
<span class="n">new_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Controls, N = 446&#39;</span> <span class="p">,</span> <span class="s1">&#39;Drug-Naïve MDDs, N = 446&#39;</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">new_labels</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;large&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;#7e3e00&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;#002878&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;#81c500&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">4.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2nd Gradient, Drug-Naïve MDDs vs. Controls:

Left Middle Temporal Gyrus, temporooccipital part , Cohen&#39;s d =  -0.23782864428990386
Right Angular Gyrus , Cohen&#39;s d =  0.2718172169707965
Right Paracingulate Gyrus , Cohen&#39;s d =  0.2496368046258911
</pre></div>
</div>
<img alt="_images/Results_39_1.png" src="_images/Results_39_1.png" />
<img alt="_images/Results_39_2.png" src="_images/Results_39_2.png" />
</div>
</div>
<p>In the second gradient, the regions having the greatest spatial overlap with the DMN (above: the right angular gyrus and right paracingulate gyrus) were closer to zero in the drug-naïve group and, consequently, to the DMN which, as pointed out above, was attributed transitional values near zero. Conversely, in controls, these same regions were closer to the ventral attention network in terms of scores. The sign of the effect was reversed for the left middle temporal gyrus, temporooccipital part, which covers the junction of the DMN, frontoparietal and ventral attention networks: the region was situated farther away from zero along the second gradient in the drug-naïve group. This shift towards the negative end of the spectrum makes this region functionally closer to the networks obtaining similar scores in controls: the ventral attention and frontoparietal.</p>
</div>
<div class="section" id="disruption-of-the-second-gradient-within-ventral-attention-network-in-patients-on-medication">
<h2>Disruption of the second Gradient within Ventral Attention Network in Patients on Medication<a class="headerlink" href="#disruption-of-the-second-gradient-within-ventral-attention-network-in-patients-on-medication" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#MED vs. NC, 1st Gradient</span>
<span class="n">data_sig_regions_MED_NC_1</span> <span class="o">=</span> <span class="n">pointplot_df</span><span class="p">(</span><span class="n">permuted_MED_NC_1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">projs_MED_MDD</span><span class="p">,</span> <span class="n">projs_NC_small</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;MDDs on Medication&#39;</span><span class="p">,</span>
                                                                                                   <span class="s1">&#39;Controls&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No significant difference between groups.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">2nd Gradient, MDDs on Medication vs. Controls:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">print_cohen_d</span><span class="p">(</span><span class="n">ols_perm_d_MED_NC_2</span><span class="p">)</span>

<span class="n">plot_stat_surf</span><span class="p">(</span><span class="n">ols_perm_d_MED_NC_2</span><span class="p">,</span> <span class="s1">&#39;infl&#39;</span><span class="p">,</span> <span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">colorbar_4</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">darkness</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">)</span>

<span class="n">data_sig_regions_MED_NC_2</span> <span class="o">=</span> <span class="n">pointplot_df</span><span class="p">(</span><span class="n">permuted_MED_NC_2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">projs_MED_MDD</span><span class="p">,</span> <span class="n">projs_NC_small</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;MDDs on Medication&#39;</span><span class="p">,</span>
                                                                                                   <span class="s1">&#39;Controls&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>

<span class="c1"># Initialize the figure</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Show the conditional means</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Gradient Score&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;ROI&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Group&quot;</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tab:green&#39;</span><span class="p">],</span>
              <span class="n">data</span><span class="o">=</span><span class="n">data_sig_regions_MED_NC_2</span><span class="p">[</span><span class="n">data_sig_regions_MED_NC_2</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MDDs on Medication&#39;</span><span class="p">],</span> <span class="n">dodge</span><span class="o">=.</span><span class="mi">532</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">,</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([],[],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Gradient Score&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;ROI&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Group&quot;</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">],</span>
              <span class="n">data</span><span class="o">=</span><span class="n">data_sig_regions_MED_NC_2</span><span class="p">[</span><span class="n">data_sig_regions_MED_NC_2</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Controls&#39;</span><span class="p">],</span> <span class="n">dodge</span><span class="o">=.</span><span class="mi">532</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">,</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([],[],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span> <span class="mi">14</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span> <span class="mi">14</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Gradient Score&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ROI&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>

<span class="c1"># Improve the legend</span>
<span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;tab:orange&quot;</span><span class="p">,</span> <span class="s2">&quot;tab:green&quot;</span><span class="p">]</span>
<span class="n">handles</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">:</span>
    <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
    
<span class="n">handles</span> <span class="o">=</span> <span class="p">[(</span><span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">]</span>
<span class="n">new_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Controls, N = 382&#39;</span> <span class="p">,</span> <span class="s1">&#39;MDDs on Medication, N = 382&#39;</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">new_labels</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;large&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;#006aff&quot;</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">4.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2nd Gradient, MDDs on Medication vs. Controls:

Right Frontal Operculum Cortex , Cohen&#39;s d =  0.23198477816467322
</pre></div>
</div>
<img alt="_images/Results_43_1.png" src="_images/Results_43_1.png" />
<img alt="_images/Results_43_2.png" src="_images/Results_43_2.png" />
</div>
</div>
<p>The comparison of the first gradient scores between controls and MDD patients on medication revealed a significant difference. However, the right frontal operculum, which is situated in the ventral attention network, had a significantly higher second gradient score in patients on medication (Cohen’s d = 0.231). More specifically, it was closer to zero and farther from the negative end of the spectrum (above) occupied by the frontoparietal and ventral attention networks. This finding putatively suggests lower functional connectivity within the ventral attention network in subjects on antidepressants due to a longer distance between the region in question and the rest of the network along the second gradient.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="Methodology.html" title="previous page">Methodology</a>
    <a class='right-next' id="next-link" href="Discussion.html" title="next page">Discussion</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Victoria Shevchenko<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>